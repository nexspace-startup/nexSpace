@tailwind base;
@tailwind components;
@tailwind utilities;

@layer components {
  /* Form labels & errors */
  .label      { @apply block text-sm font-medium text-neutral-800; }
  .error-text { @apply text-sm text-rose-600 mt-1; }

  /* Inputs */
  .input-base {
    @apply w-full rounded-xl border px-4 py-2 text-neutral-900 placeholder-neutral-400
           focus:outline-none focus:ring-2 focus:ring-neutral-300 transition-colors;
  }
  .input-normal { @apply border-neutral-200; }
  .input-error  { @apply border-rose-400; }

  /* Selects */
  .select-base {
    @apply w-full appearance-none rounded-xl border px-4 py-2 pr-10 text-neutral-900
           focus:outline-none focus:ring-2 focus:ring-neutral-300 transition-colors;
  }
  .select-normal { @apply border-neutral-200; }
  .select-error  { @apply border-rose-400; }

  /* Buttons (setup screens) */
  .btn-primary {
    @apply w-full rounded-xl bg-neutral-900 px-4 py-2 text-white text-lg font-medium
           transition-colors disabled:opacity-60 disabled:cursor-not-allowed;
  }
  .btn-ghost { @apply rounded-xl border border-neutral-200 px-3 py-2 text-sm; }

  /* Titles */
  .heading-xl { @apply text-3xl font-semibold text-neutral-900; }
  .subheading { @apply text-neutral-500; }

  /* Progress Bar */
  .progress-track { @apply relative h-1 rounded-full bg-neutral-200; }
  .progress-fill  { @apply absolute left-0 top-1/2 h-1 -translate-y-1/2 rounded-full bg-gradient-to-r from-blue-400 via-blue-600 to-black transition-all duration-500; }
  .progress-dot   { @apply absolute top-1/2 -translate-y-1/2 -translate-x-1/2 transition-all duration-500; }
  .progress-knob  { @apply block h-3 w-3 rounded-full bg-black shadow-sm; }
  .progress-labels { @apply mt-3 flex justify-between text-sm; }
  .progress-label-active { @apply text-black font-medium; }
  .progress-label-done   { @apply text-neutral-800; }
  .progress-label-pending{ @apply text-neutral-400; }

  /* Meeting UI: pills, buttons, tiles, controls */
  .pill-dark { @apply px-4 rounded-[20px] bg-[#18181B] shadow-md flex items-center justify-between; }
  .btn-danger { @apply h-8 px-3 rounded-xl bg-[#ED5C5B] text-white text-xs font-semibold hover:brightness-110; }
  .btn-cta    { @apply h-10 px-4 rounded-2xl bg-[#4285F4] text-white text-sm font-semibold disabled:opacity-60; }

  .control-bar { @apply bg-[#18181B] rounded-[20px] px-6 flex items-center justify-between; }
  /* Larger touch targets on mobile */
    .ctrl-btn    { @apply w-12 h-12 sm:w-10 sm:h-10 rounded-full bg-[#202024] grid place-items-center transition-colors; }
    .ctrl-btn:hover { background-color: #26272B; }
    .ctrl-btn:active { transform: scale(0.98); }
    .ctrl-btn svg { transition: transform 120ms ease, color 120ms ease, opacity 120ms ease; }
    .ctrl-btn:hover svg { transform: scale(1.06); }
    .ctrl-btn:active svg { transform: scale(0.94); }

  .segmented         { @apply flex items-center bg-[#202024] rounded-full p-1; }
  .segmented-active  { @apply px-3 h-8 rounded-full bg-white/10 text-white text-sm font-semibold; }
  .segmented-inactive{ @apply px-3 h-8 rounded-full text-[#80889B] text-sm; }

  .btn-circle-ghost { @apply w-8 h-8 rounded-full bg-[#202024] grid place-items-center text-white/70 disabled:opacity-40; }

  .tile-profile       { @apply relative w-[120px] h-[134px] rounded-xl bg-[#18181B] flex flex-col items-center justify-center gap-3 isolate; }
  .avatar-box         { @apply relative w-[88px] h-[64px] flex items-center justify-center rounded-[12px]; }
  .avatar             { @apply w-16 h-16 rounded-full overflow-hidden shadow-[0_4px_15px_rgba(0,0,0,0.2)] grid place-items-center; }
  .avatar-placeholder { @apply w-full h-full bg-[#1F1F23] grid place-items-center; }
  .avatar-speaking    { @apply ring-2 ring-[#48FFA4] shadow-[0_0_16px_rgba(72,255,164,0.45)] transition-shadow; }

  /* Top widget: 24px avatars with slight overlap */
  .avatar-24 { @apply box-border w-6 h-6 rounded-full border border-[#26272B] overflow-hidden; }
  .avatar-stack-24 { @apply relative h-6 w-14; }
  .avatar-counter-24 { @apply absolute grid place-items-center w-6 h-6 rounded-full bg-[#202024] border border-[#26272B] text-[10px] leading-[14px] font-medium text-[#80889B]; }

  /* Fixed-width timer readout to avoid layout shift */
  .time-readout { @apply inline-block text-center tabular-nums text-xs sm:text-sm font-semibold text-[#FE741F] w-[10ch] sm:w-[12ch]; }

  /* Navbar panel */
  .nav-btn         { @apply w-12 h-12 grid place-items-center rounded-2xl transition-colors hover:bg-white/5; }
  .nav-btn-active  { @apply bg-[#202024]; }

  /* Responsive tweaks for setup screens */
  @screen sm {
    .section-pad { @apply px-10; }
    .heading-xl  { @apply text-xl; }
  }

  /* Meeting: top widget pill */
  .widget-top { @apply absolute z-20; }
  .widget-top-inner {
    @apply flex items-center justify-center gap-6 pl-4 pr-6 py-[14px] rounded-[20px] bg-[#18181B] shadow-[1px_1px_15px_rgba(0,0,0,0.2)];
  }
  .status-chip { @apply flex items-center gap-2 h-8 px-3 bg-[#202024] rounded-xl text-white text-sm font-medium font-manrope; }
  .icon-16 { @apply w-4 h-4; }
  .icon-20 { @apply w-5 h-5; }
  /* Vertical fade separator (top widget) */
  .sep-vert { @apply w-0 h-6 border border-[#26272B]}
  /* .sep-vert { @apply w-2 h-8; background-image: linear-gradient(to bottom, rgba(38,39,43,0), #26272B, rgba(38,39,43,0)); } */
  .icon-btn-ghost { @apply w-8 h-8 rounded-full bg-[#202024] grid place-items-center; }
  .avatar-stack { @apply relative h-6 w-20; }
  .avatar-16 { @apply box-border w-6 h-6 rounded-full border border-[#26272B] overflow-hidden; }
  .avatar-counter { @apply absolute grid place-items-center w-6 h-6 rounded-full bg-[#202024] border border-[#26272B] text-[10px] leading-3 font-medium text-[#80889B]; }
  .chev-btn { @apply w-5 h-5 grid place-items-center text-[#80889B]; }

  /* Dropdown menu */
  .menu { @apply absolute mt-2 left-0 w-44 rounded-lg bg-[#202024] shadow-lg border border-[#26272B] py-1; }
  .menu-item { @apply px-3 py-2 text-sm text-white/90 hover:bg-white/5 flex items-center gap-2; }

  /* Presence flyout */
  .presence-flyout {
    @apply w-[min(710px,calc(100vw-16px))] max-h-[80vh] sm:max-h-[70vh] bg-[#18181B] border border-[#26272B]
           rounded-[16px] sm:rounded-[20px]
           shadow-[1px_1px_15px_rgba(0,0,0,0.2)] p-4 sm:p-6 flex flex-col gap-4 sm:gap-6;
  }
  .presence-search {
    @apply box-border flex items-center gap-2 px-3 h-10 w-full bg-[rgba(128,136,155,0.1)] border border-[#26272B] rounded-2xl;
  }
  .presence-item {
    @apply w-full grid grid-cols-[minmax(0,1fr)_auto] sm:grid-cols-[auto_126px_auto]
           items-center py-3 gap-x-4 gap-y-3; /* left column shrinks to content so status sits closer */
  }
  .presence-badge {
    @apply h-7 px-3 rounded-lg flex items-center gap-2 justify-center whitespace-nowrap w-[126px];
  }
  /* Toasts */
  .toast-stack { @apply fixed z-[1000] right-6 top-6 flex flex-col gap-3 w-[min(560px,calc(100vw-24px))]; }
  .toast-base  { @apply flex items-center gap-3 px-4 py-3 rounded-2xl shadow-sm border border-[#26272B]; }
  .toast-success { @apply bg-[#234936] text-[#48FFA4]; }
  .toast-error   { @apply bg-[#4E2B2B] text-[#ED5C5B]; }
  .toast-warning { @apply bg-[#4B3A29] text-[#F59E0B]; }

    /* Chat scrollbars: keep a stable gutter to avoid content shift.
       Hide by making the thumb transparent; reveal during scrolling only. */
    .chat-scroll { scrollbar-width: thin; scrollbar-gutter: stable; scrollbar-color: transparent transparent; }
    .chat-scroll.scrolling { scrollbar-width: thin; scrollbar-color: rgba(128,136,155,0.5) transparent; }
    .chat-scroll::-webkit-scrollbar { width: 3px; height: 3px; }
    .chat-scroll::-webkit-scrollbar-thumb { background-color: transparent; border-radius: 8px; }
    .chat-scroll.scrolling::-webkit-scrollbar-thumb { background-color: rgba(128,136,155,0.6); }
  .chat-scroll::-webkit-scrollbar-track { background: transparent; }
}

/* Speaking pulse halo for profile tiles */
@keyframes pulse-ring {
  0% { transform: scale(1); opacity: .55; }
  100% { transform: scale(1.10); opacity: .90; }
}
.pulse-ring { animation: pulse-ring 900ms ease-out infinite alternate; }

/* Scoped theme variables for Meeting3D only */
.ns-meeting3d.theme-dark {
  --text-1: #ffffff;
  --text-2: #cfd3dc;
  --panel-bg: #1f2330;
  --panel-text: #ffffff;
  --panel-border: #3b3f4b;
  --panel-subtle: #2b2f3b;
  --surface-1: #18181B;
  --surface-2: #202024;
  --accent: #3D93F8;
}
.ns-meeting3d.theme-light {
  --text-1: #0f172a;
  --text-2: #334155;
  --panel-bg: #ffffff;
  --panel-text: #0f172a;
  --panel-border: #e5e7eb;
  --panel-subtle: #f3f4f6;
  --surface-1: #ffffff;
  --surface-2: #f8fafc;
  --accent: #2563eb;
}

:root {
  --app-bg: #0b0f16;
  --text-1: #ffffff;
  --text-2: #cfd3dc;
  --panel-bg: #1f2330;
  --panel-text: #ffffff;
  --panel-border: #3b3f4b;
  --panel-subtle: #2b2f3b;
  --surface-1: #18181B;
  --surface-2: #202024;
  --ring: #26272B;
  --accent: #3D93F8;
}
html[data-theme="light"] {
  --app-bg: #f3f4f6;
  --text-1: #0f172a;
  --text-2: #334155;
  --panel-bg: #ffffff;
  --panel-text: #0f172a;
  --panel-border: #e5e7eb;
  --panel-subtle: #f3f4f6;
  --surface-1: #ffffff;
  --surface-2: #f8fafc;
  --ring: #e5e7eb;
  --accent: #2563eb;
}

/* Apply background */
body { background: var(--app-bg); color: var(--text-1); }

/* Override key surfaces to use variables */
.control-bar { background-color: var(--surface-1) !important; }
.pill-dark { background-color: var(--surface-1) !important; color: var(--text-1) !important; }
.widget-top-inner { background-color: var(--surface-1) !important; }
.status-chip { background-color: var(--surface-2) !important; }
.btn-circle-ghost { background-color: var(--surface-2) !important; }
.menu { background-color: var(--surface-2) !important; border-color: var(--ring) !important; }
.tile-profile { background-color: var(--surface-1) !important; }


